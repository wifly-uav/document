# 強化学習概要

## 渡邉研の先行研究と歴史
- 2018年
  - 伊勢さん修論(WiFly1のPitch角について)
- 2019年
  - 岩城さん修論(WiFly2のYaw角について)
  - 桑島さん卒論(WiFly2のPitch角について)
- 2021年
  - 中村さん修論(WiFly2のYaw角について)
  - 斎藤さん卒論(WiFly2のYaw角について)
- 2022年
  - 桑島さん修論(WiFly-VのRoll角について)
  - 岡本修論(WiFly2のYaw角について)
  - 平井さん卒論(WiFly2のYaw角について)

2019年以前はプログラムが怪しい（卒修論の説明と合ってない）ので無視を推奨
2021年の中村さん修論もやっていることが怪しいので無視を推奨
2022年以降はTensorflow2.xに変更されている

伊勢さんから強化学習を始めた。その後、岩城さん、桑島さん、中村さんと強化学習をテーマに卒宗論に取り組んでいる。しかし、電物の先生方があまり分かっていないこと、再現実験が不可能なことから正直ちゃんとした研究はしていないと言っていいレベル。また、ネットに落ちているコードをコピペしてプログラムを実装していたため、意図した動作になっていない。

2021年の斎藤さんからPIDと強化学習を組み合わせる研究を始めた。PIDのゲインを強化学習で決定する手法となっている。このアイディアは、この動画[]がもとになっている。組み合わせた理由としては、時間が無かったためである。10月中旬になっても卒論がまったく進んでいなかったため、安定しやすいPID制御と強化学習を組み合わせることで短期間である程度結果が得られる実験を研究テーマとした。結果としては正直よく分からなかった。1つのゲインに決められることもあれば、いくつかのゲインを選択することもあった。前者については、ゲインチューニングがうまくいったと思われる。後者は、学習できていないかもしれないし、ゲインの選択に何かしらの意味があるのかもしれない。この研究で課題となったのは、ニューラルネットワークの初期値の影響が大きい。これは、学習回数が少ないためであり、Q値が収束していないと考えられる。また、羽ばたいている途中に最適なゲインは変わると考えられるが、あまりゲインの選択が変わっていない。他にも実験環境が特殊であり、学習環境として良いのか分からない等、課題がいっぱいある。

2022年の桑島さんは、修士2年の12月から実験を始めているのでよく知らないし、参考にするのはおすすめしない。岡本は、斎藤さんの課題の2つ目に注目して研究を行い、ゲインスケジュール制御を目標とした。機体の状態をある程度推定することで機体の状態変化を学習対象に追加した。平井さんは、斎藤さんの課題の1つ目に注目して研究を行った。意図的に行動を選択させることで初期値の影響を小さくした。

## 使用アルゴリズム
* DQN
* DDPG
* PPO
  
最も使われているのはDQN、中村さんがDDPGを使い、PPOは謝さんが取り組んでいる。DQNについては真空ゼミで学んでほしい。DQNがニューラルネットワークの中で出力層のニューロンの大小だけを考慮するのに対して、DDPGは、出力層のニューロンの値そのものを使うことで連続値で行動を選択する手法である......と思う。(よく知らない)　PPOは、方策ベースのアルゴリズムである。行動価値の大小で行動を決定するのではなく、確率分布を用いて行動を決定していく。方策ベースは連続値を出力できるが学習効率が悪い。そこで学習サンプルを効率化した手法がDDPGとなる。学習自体を最適化した手法がPPOになる。

## 一般的な強化学習の研究について
ロボットの制御に強化学習を適応した研究は、国際学会ではあまり見られない。(画像処理に使う例はよくある)　他大の国際学会に行った友人曰く、強化学習xロボット制御の論文はリジェクトされるらしい。また、制御対象にしても歩行ロボットが多い。強化学習の対象にし易いらしい。(理由は忘れた) 制御工学を学んでいる人は、制御式の中に強化学習が入るのを嫌う。これは、制御においてモデルがどういった状態なら安定するかが重要であるからである。何秒以内に収束するとか、機体のモデル化がこの程度ズレいていても制御できるとか、機体が何度以内の傾きなら復帰できるとかである。強化学習を使うと式から安定を議論できない上に学習していない状態に対する行動は未知である。そのため、制御屋は強化学習を嫌う。そこで機体の状態を推定する部分や機体のモデルを同定する場面で強化学習を使うことが多い。

## 理論(気になるところ)
### マルコフ決定過程
* 理論では、行動の影響は次の状態に影響するが、機体の場合は次の観測に行動の影響があまりない。
* 機体では、行動の指令を出しても瞬時にその行動にならない
* Iゲインは積分項があるが、Iゲインの選択はマルコフ決定過程を満たすのか