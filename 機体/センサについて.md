# センサー

これまで使用したセンサーと新規センサーの候補と採用する際の注意点について説明する。

## これまでに使用したセンサー
### 機体に搭載
- IMU
→角度を取得
- 気圧センサー
→高度を取得
- レーザー距離センサー
→高度を取得
- 温度センサー
→他のセンサの補正
### 測定に使用
- 電圧センサー
→バッテリーの電圧を測定
- 電流センサー
→モーターに流れてる電流を測定
- 回転計（ロータリーエンコーダ）
→ブラシレスモータの動作に必要
- フォトリフレクタ
→羽ばたき周波数を測定
- 音センサー
→羽ばたき周波数を測定

IMUは、LazuriteFly搭載のkxg03と現在使用中のBNO055を使用。kxg03は6軸、BNO055は地磁気を追加した9軸で測定を行っている。
気圧センサーは、LazuriteFly搭載のBM1383を使用。羽ばたきの風で気圧が変ってしまうため、あまり精度は良くなかった。
レーザー距離センサーは、VL53L0Xを使用。精度良く高度を測定することができた。しかし、高度を測定したいときは地面に対して常に垂直になるように搭載する必要がある。
温度センサは、各センサーに搭載されている。一応、値として取得可能だがセンサーのキャリブレーションは自動的に行われるので意図的に使用したことはない。

電圧センサーは、DE-2645-02のデジタルメータを使用。電圧を測定できるものの値として取得できず、インジケータを見る必要があった。羽ばたいている最中の電圧は乱上下しているため、あまり精度よく測定できなかった。
電流センサーは、INA219を使用。バッテリーから流れる電流を測定した。あまり時間がなく、結果の考察ができていない。
フォトリフレクタは、羽が付いていない状態のギアボックスに対してピアノ線をフォトリフレクタに反射させることで羽ばたき周波数を測定した。測定自体は、うまくできていたものの揚力との相関があまり無かった。
音センサは、羽ばたいている音を測定してフーリエ変換をすることで羽ばたき周波数を測定した。容易に測定できたもののノイズが大きくあまり精度が良くなかった。

## 新規センサー
### 候補
- ビジョンセンサー
- 超音波距離センサー
- 集電センサー
- 照度センサー
- 回転計
- 圧力センサー

ビジョンセンサーはカメラ。詳細は、画像処理の方を見て。
超音波距離センサーは、その名の通り距離を測定できるセンサー。レーザー距離センサーとは異なり、ある程度の範囲を測定できる。センサーの前に物体があったとき、一番近いものとの距離を測定する。機体が傾いたときの高度測定や障害物の検知ができると思う。ただ、ちょっと重い。使うならHCSR-04が手に入りやすい。
集電センサーは、熱源が分かるセンサー。人の存在を検知できるから人にはぶつからないようにできるかも。使ったことない。ワカラン。
照度センサーは、明るさが分かるセンサー。虫みたいに電灯に向かって飛行ができるかも。使ったことない。ワカラン。
回転計は、モーターの回転速度を測定する。モーターの回転速度が分かるとバッテリー電圧やモーターの発熱を気にしなくてよくなる。ロータリーエンコーダや磁気エンコーダがあるが、重い。
圧力センサーは、荷重を測定する。尾翼につければ尾翼がどれぐらいの力を受けているか分かる。そこから尾翼制御や無尾翼化につながるかも。あと曲げセンサーで曲がり具合を測定できるセンサーを使うと何か面白いことが分かるかも。

### 新規センサーの注意点

- そのセンサーを使っている記事やブログがあるか
あるなら何も考えず、そこに従って使えば良い。
- センサーがそのまま使えるか
基板として完成している場合とICだけの場合がある。ICだけだと回路を設計する必要があるため、めんどくさい。
- 動作電圧
何Vで動作するのかデータシートで確認する必要がある。3.3vは安定して供給できるが、それ以外だと昇圧、降圧が別途必要。バッテリーから直接は電圧が不安定なのであまりおすすめしない。
- 出力形式
マイコンと通信するタイプとしないタイプがある。通信するタイプは、I2C,SPI,UART,CANがある。2022年マイコンではI2CとUARTは通信可能。通信しないタイプだと、アナログ電圧(0V~3.3V or 5V)やLow,Highの時間などがある。アナログ電圧の場合、マイコンにADC搭載のピンに接続する必要がある。Low,Highはインプット可能なピンならどこでも良い。ただ、2022年マイコンはピンが余ってない。
- 公開されているプログラムの有無
一般的には、動作させるためのプログラムを誰かが公開している。他人のプログラムを使った方がかなり楽できる。ただ、公開されているプログラムは動かないことも多いので過信しないように。
- 特性
距離センサの例だとどの範囲が測定できるのか、太陽光の影響等の特性。予想外の動作をしたときや考察でその知識が必要になる。