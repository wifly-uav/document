# モーターについて

## 種類
研究室に関係あるモーターとしては、大きく4つのモーターがある。
- ブラシ付きモーター(DCモーター)
機体に搭載しているモーター
- ブラシレスモーター
これから機体に搭載したいモーター
- ステッピングモーター
3Dプリンターやレーザーカッターに使われているモーター
- 交流モーター
電物実験で扱ったモーター（すべりがどうとか言ってたやつ）

## ブラシ付きモーター
ブラシ付きモーターの中でもコアの有無によって
- コアレスモーター
- コアードモーター

に分類される。また、磁石の種類で
- 永久磁石界磁型
- 電磁石界磁型(大型)

に分類される。
WiFlyに使われているのは、ブラシ付き永久磁石界磁型コアレスモーター。

### コアレスとコアード
コアレスモータはコアがない分慣性モーメントが小さいため、非常に応答性がよい。 また磁石とコイルの位置が近く、効率が高い。さらに進角を行う必要がないため、正転、逆転の回転数に差がない。 ただし、生産性が非常に悪いため高価となっている。 また、熱に弱いと言われている。
コアードモータのロータはコアに巻線が巻かれている。すなわち巻線という熱源にコアが接しているため，巻線で発生した熱もコアが大きな熱容量を持っており，かつ空気よりも熱抵抗が小さいため，巻線で発生した熱は空気中よりも先にコアに熱が移動する．このため，熱が発生しても巻線自体の温度上昇はそこまで大きくない。逆に，コアレスモータは巻線のまわりは空気中であり，コアも存在しないのでロータの熱容量は実質巻線のみになる。このため，同じだけのジュール熱が発生しても，コアレスモータのほうが熱容量が小さい分、温度上昇の割合が高いということになる。以上から，巻線の温度が上昇しやすく，巻線の焼損温度に達する可能性が高いことから，「コアレスモータは熱に弱い」と言われている。

### 特性
各モーターごとに以下のような特性図がある。
<img src="/img/chara.png" width=500>

横軸をトルクとしてn:効率,P:出力,N:回転数,I:電流を示している。

[マブチモーターさんの実験結果](https://www.mabuchi-motor.co.jp/product/knowledge/performance/voltage.html)を参考にしてほしい。(ここに結果を貼るのは著作権的にアレなので)

動作させる場合は
- 電圧
- 電源
- 温度

選定する場合は
- 巻線

の結果を見て。


## ブラシレスモーター
電源はDC,モーターには3相交流を使うため、直流モーターとも3相交流モーターとも呼ばれる。ここではBLDCモーターとして扱う。
BLDCモータはモータ中のコイルの電極を切り替える際に、ブラシと整流子による機械的な接点切り替えではなく回路的な切り替えによって回転するモータである。ブラシ付きモータに比べ機械的な接点が減るため一般に高効率で応答性、制御性が高いと言われている。また電磁石側ではなく永久磁石側が回転することが多いため扁平な形のモータといった、ブラシモータとはまた違った形状のものが存在する。
動作の概要は[ルネサスの画像](https://www.renesas.com/jp/ja/support/technical-resources/engineer-school/brushless-dc-motor-01-overview.html)が分かりやすい。
特徴
- ブラシレスDCモータは大体3端子。(世の中に6端子のものも存在するがここでは考慮しない。)
- 正しく回転させるにはロータの角度を検知してその瞬間に最適な端子に電圧をかける必要がある。つまり適当に電源につなぐだけでは回せず、回路と制御が必要になる。
- ロータの角度検出の際にホールセンサを使う場合がある。基本的にモータの中に組み込まれていることが多くこれをセンサードBLDCと呼んだりする。
- ホールセンサがなくとも端子にかかっている電圧を検知することで駆動できる。ホールセンサまたはエンコーダといった角度検出センサがない状態で回すことをセンサレス駆動という。
- よくあるブラシ付きモータと同様に中のロータが回転するタイプと、それらとは異なりモータのガワが回転するタイプがある。それぞれインナーロータとアウターロータと呼ぶ場合がある
  
### 駆動方法
3相のBLDC駆動回路は、ハーフブリッジ回路が3つ必要になる。3つのハーフブリッジ回路のモータ出力部分をモータ端子に繋ぐことになる。
<img src="/img/brushless.png" width=500>
簡単な駆動方法は3つのハーフブリッジのうち、1つはハイサイドがONでローサイドがOFF、1つはハイサイドがOFFでローサイドがON、最後の一つがハイサイドもローサイドもOFFという状態をあてはめるものでこれは「120°通電(矩形波駆動)」と呼ばれる。
120°通電 については[東芝のアプリケーションノート](https://toshiba.semicon-storage.com/info/docget.jsp?did=61175)が参考になる。120°通電については、説明しないので各自でこのサイトを確認してほしい。

実際に駆動させるときは、1:[ハイサイドON , ローサイドOFF]、2:[ハイサイドOFF , ローサイドOFF]、3:[ハイサイドOFF , ローサイドON] といったように表現すると以下のサイクルをひたすら繰り返せばよい。
1:[ON , OFF]、2:[OFF , ON ]、3:[OFF , OFF]　→（上の画像の状態）
1:[ON , OFF]、2:[OFF , OFF]、3:[OFF , ON ]　→
1:[OFF , OFF]、2:[ON , OFF]、3:[OFF , ON ]　→
1:[OFF , ON ]、2:[ON , OFF]、3:[OFF , OFF]　→
1:[OFF , ON ]、2:[OFF , OFF]、3:[ON , OFF ]　→
1:[OFF , OFF]、2:[OFF , ON ]、3:[ON , OFF]　→ (以降繰り返し)
逆回転させたい場合は各ハーフブリッジのON,OFFをハイサイドとローサイドで逆にすればよい。つまり以下のようになる。
1:[OFF , ON ]、2:[ON , OFF]、3:[OFF , OFF]　→
1:[OFF , ON ]、2:[OFF , OFF]、3:[ON , OFF]　→
1:[OFF , OFF]、2:[OFF , ON ]、3:[ON , OFF]　→
1:[ON , OFF]、2:[OFF , ON ]、3:[OFF , OFF]　→
1:[ON , OFF]、2:[OFF , OFF]、3:[OFF , ON ]　→
1:[OFF , OFF]、2:[ON , OFF]、3:[OFF , ON ]　→　(以降繰り返し)

#### センサードBLDC
センサードモータの場合にはロータの位置検出にホールセンサやロータリーエンコーダからの情報を使う。
センサード/センサレスの特徴については[インデックスプロのページ](https://www.indexpro.co.jp/article/detail/2/13)を見てほしい。(13~20ページ)
センサーにホールセンサーを用いる場合は、[maxsonのページ](https://www.maxongroup.co.jp/medias/sys_master/root/8807060013086/EC-Tech.pdf?attachment=true)を見てほしい。
ロータリーエンコーダは何度回転したか測定するためのセンサー。まず、1つの相（U相など）だけを励起することでロータの位置を固定する。そこからロータリーエンコーダを使うことでロータがどれぐらい回転したか測定する。

#### センサレスBLDC
機体に載せるなら恐らくセンサレスになる。
センサレスBLDCでも60度おきにローターの位置を推定してそれに応じたモータ出力をすることに変わりはない。センサレスモータでは通電していない(ハーフブリッジのハイサイドもローサイドもOFFになっている)モータの端子に生じる逆起電力でローター位置を推定する。
<img src="/img/sensorless.png" width=400>
U、V、W相の各コイルの内オフになっている相が必ず1組存在するので、通電していない相のモータ端子電圧が印加電源電圧の中点電位（1/2）になる箇所（ゼロクロス点）を検出することでロータの位置が得られる。
詳細は、[インデックスプロのページ](https://www.indexpro.co.jp/article/detail/2/17)を見てほしい。(17ページ)

###　駆動IC
BLDCでは、3つのハーフブリッジを3相交流で回転させるためのICが必要となる。6つのMOSFETが一緒になったモータードライバー(ESC)とゲートドライバーの2種類がある。モータードライバーに関しては、