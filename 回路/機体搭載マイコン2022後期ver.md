# 機体搭載マイコン(2022/後期ver)

## 搭載部品
### 1枚作成するのに必要な部品
* プリント基板 x1
* ESP-WROOM-02D x1
https://akizukidenshi.com/catalog/g/gM-13289/
* Pch パワーMOSFET AO3401A x2
https://akizukidenshi.com/catalog/g/gI-14654/
* 表面実装用タクトスイッチ x2
https://akizukidenshi.com/catalog/g/gP-14888/
* 赤色チップLED x1
https://akizukidenshi.com/catalog/g/gI-11879/
* 黄色チップLED x1
https://akizukidenshi.com/catalog/g/gI-11880/
* 3.3v レギュレータ x1
https://akizukidenshi.com/catalog/g/gI-17230/
* 10Ω抵抗1608サイズ x2
* 10kΩ抵抗1608サイズ x6
* 470Ω抵抗1608サイズ x2
* チップコンデンサ10uF2012サイズ x2
* チップコンデンサ1uF 2012サイズ x2
* 2pinコネクタ x2
https://www.sengoku.co.jp/mod/sgk_cart/detail.php?code=EEHD-4B5T
千石電商地下1F 右奥の棚にある
* 2pinメスケーブル x1
* 2pinオスケーブル x1
* 3pinメスケーブル x2
* ケーブル x4本分（2pinオスケーブル2本で代用）
* 細ピンソケット x4pin
* IMU BNO055 x1
https://akizukidenshi.com/catalog/g/gK-16996/

## 仕様
* 動作電圧:3.6~6.5v
* I2C電源:3.3v
* DCモータx2
* サーボモータx2
* I2C(センサー)x1
※DCモータ、サーボモータは電源直結
※DCモータは最大4Aまで

## マイコンについて
無線はESP-NOWを使用
ピンはほぼ余っていない

## ボタンについて
リセット用、書き込み用に2つ必要
リセット時に書き込み用ボタンを押していると書き込みモードで起動する

## 電源について
一瞬でも3.6vを下回るとマイコンの電源が落ちるため、接続が切れる
ヒューズを付けていないため、ショートに注意
安定化電源とリポバッテリーでは微妙にモーターの挙動が異なるので注意

## MOSFETについて
通常は、Hブリッジ回路を用いるが軽量化のため1スイッチ回路にしている
配線の都合でPchを使用しているが、性能と価格的にはNchの方が良い
過渡応答の対策しておらず、プルアップがレギュレータが起動してからになるため、電源を入れた瞬間は通電する
安定化電源の値からすると2A程度は耐える必要がある
MOSFETが壊れるとショートする可能性があるので注意

## コンデンサについて
ノイズ除去のために使用
モーターのノイズが大きければモーターに対して並列に0.1uFのコンデンサを入れると良い

## センサーについて
現在はセンサー上でカルマンフィルタをしてくれているBNO055を使用中
このセンサーは人気なため、売り切れに注意
似たものにBMX055があるが、これはカルマンフィルタをしていないので注意
I2Cは並列にセンサーを繋げるので他のセンサーも同時に使用可能